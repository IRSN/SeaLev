<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="

Build a spline density from a provided grid density.
The methods plot, print and predict can be used."><title>Build a spline density from a provided grid density — SplineDensity • SeaLev</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Build a spline density from a provided grid density — SplineDensity"><meta property="og:description" content="

Build a spline density from a provided grid density.
The methods plot, print and predict can be used."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SeaLev</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4-4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Build a spline density from a provided grid density</h1>
      
      <div class="d-none name"><code>SplineDensity.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    

<p>Build a spline density from a provided grid density.</p>
<p>The methods <code>plot</code>, <code>print</code> and <code>predict</code> can be used.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">SplineDensity</span><span class="op">(</span><span class="va">x</span>, <span class="va">f</span>,</span>
<span>              xmin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, xmax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>              leftDerivEst <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0L</span>, <span class="fl">1L</span><span class="op">)</span>, rightDerivEst <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0L</span>, <span class="fl">1L</span><span class="op">)</span>,</span>
<span>              leftDeriv <span class="op">=</span> <span class="cn">NULL</span>, rightDeriv <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>              knots <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>              nKnots <span class="op">=</span> <span class="fl">24L</span>,</span>
<span>              order <span class="op">=</span> <span class="fl">4L</span>,</span>
<span>              plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>              check <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd>

<p>Numeric vector of values at which the density is provided.</p>
<p></p></dd>

  <dt>f</dt>
<dd>

<p>Numeric vector of density values corresponding to <code>x</code>.</p>
<p></p></dd>

  <dt>xmin</dt>
<dd>

<p>Left (or lower) end-point of the distribution.</p>    
<p></p></dd>

  <dt>xmax</dt>
<dd>

<p>Right (or upper) end-point.</p>
<p></p></dd>

  <dt>leftDerivEst</dt>
<dd>

<p>Integer vector giving the order of the derivatives that will be
    estimated from the finite differences of the points in <code>x</code> and
    <code>f</code>. These values will be used even if derivatives are
    provided.</p>    
<p></p></dd>

  <dt>rightDerivEst</dt>
<dd>

<p>Similar to <code>leftDerivEst</code>.</p>
<p></p></dd>

  <dt>leftDeriv</dt>
<dd>

<p>Vector of known derivatives at left end-point (if any). The given
    values are for order \(0\) to \(k-2\) in that order where
    \(k\) is the order. Unknown values are to be given as <code>NA</code>.</p>
<p></p></dd>

  <dt>rightDeriv</dt>
<dd>

<p>Similar to <code>rightDeriv</code> for the upper end-point.</p>
<p></p></dd>

  <dt>knots</dt>
<dd>

<p>A numeric vector of knots in ascending order.</p>
<p></p></dd>

  <dt>nKnots</dt>
<dd>

<p>Number of knots to be used if <code>knots</code> is not provided.</p>
<p></p></dd>

  <dt>order</dt>
<dd>

<p>The spline order \(k\), e.g. \(k = 1\) for a broken line spline
    and <code>k = 4</code> for a cubic spline.</p>
<p></p></dd>

  <dt>plot</dt>
<dd>

<p>Logical. If <code>TRUE</code> a plot is provided.</p>
<p></p></dd>

  <dt>check</dt>
<dd>

<p>Logical. When <code>TRUE</code>, some check of the computations are
    carried over and results are printed.</p>    
<p></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    
  

<p>A list object that can be used for density computations. This object
  is given an S3 class <code>"SplineDensity"</code>. The structure of this
  list might evolve in the future life of the package.</p>
  

    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    

<p>A spline approximation for a given density is found by a
  constrained regression. First, a suitable basis of B-splines is
  built. Then the coefficients are found in order to minimise the
  distance to the provided density values with constraints arising
  from boundary conditions and from the normalisation condition.
  Boundary conditions can be given. By default, the values of the
  density and of its first order derivative are taken equal to a
  finite difference estimation from <code>x</code> and <code>f</code>. This
  works correctly when the grid is fine enough, and when the
  provided values correspond to those of a continuous function with
  continuous derivative on the closed interval with end-points
  <code>xmin</code> and <code>xmax</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    
  
<p>de Boor, C (2001) <em>A Practical Guide to Splines</em>, revised
  edition. Springer-Verlag.</p>
    </div>
    <div class="section level2">
    <h2 id="caution">Caution<a class="anchor" aria-label="anchor" href="#caution"></a></h2>
    

<p>The spline is not warranted to be positive. This will be the case if
  positive density values are provided in <code>f</code> and if the grid is
  fine enough.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    

<p>Yves Deville</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
  
<p><code><a href="rSplineDensity.html">rSplineDensity</a></code> to generate randomly drawn objects
  (e.g. for tests). <code><a href="predict.SplineDensity.html">predict.SplineDensity</a></code> for the
  evaluation at chosen points.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Brest.tide</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">SD</span> <span class="op">&lt;-</span> <span class="fu">SplineDensity</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Brest.tide</span><span class="op">$</span><span class="va">x</span>, f <span class="op">=</span> <span class="va">Brest.tide</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> leftDeriv = 0 9.381932e-06 NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rightDeriv = 0 -2.479663e-05 NA </span>
<span class="r-in"><span><span class="va">SD24</span> <span class="op">&lt;-</span> <span class="fu">SplineDensity</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Brest.tide</span><span class="op">$</span><span class="va">x</span>, f <span class="op">=</span> <span class="va">Brest.tide</span><span class="op">$</span><span class="va">y</span>, nKnots <span class="op">=</span> <span class="fl">24</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> leftDeriv = 0 9.381932e-06 NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rightDeriv = 0 -2.479663e-05 NA </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## approximate a bounded GPD (negative shape) by a spline density</span></span></span>
<span class="r-in"><span><span class="va">shape</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">x</span> <span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="va">shape</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">shape</span></span></span>
<span class="r-in"><span><span class="va">SDGP</span> <span class="op">&lt;-</span> <span class="fu">SplineDensity</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, f <span class="op">=</span> <span class="va">f</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> leftDeriv = 3.342225 -7.80186 NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rightDeriv = 0 -0.00274446 NA </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">SDGP</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="SplineDensity-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Yves Deville.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

